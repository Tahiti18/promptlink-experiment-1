<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PromptLink - Revolutionary AI Orchestration Platform</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-green: #10B981;
            --primary-blue: #3B82F6;
            --primary-purple: #8B5CF6;
            --dark-bg: #0F172A;
            --card-bg: #1E293B;
            --border-color: #334155;
            --text-primary: #F8FAFC;
            --text-secondary: #94A3B8;
            --success: #10B981;
            --warning: #F59E0B;
            --error: #EF4444;
        }
        
        * {
            box-sizing: border-box;
        }
        
        body {
            background: var(--dark-bg);
            color: var(--text-primary);
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            line-height: 1.6;
        }
        
        .gradient-border {
            background: linear-gradient(135deg, var(--primary-green), var(--primary-blue));
            padding: 2px;
            border-radius: 12px;
            margin-bottom: 1.5rem;
        }
        
        .gradient-border-content {
            background: var(--card-bg);
            border-radius: 10px;
            padding: 1.5rem;
            height: 100%;
        }
        
        .logo-text {
            background: linear-gradient(135deg, var(--primary-green), var(--primary-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 700;
            font-size: 1.5rem;
        }
        
        .agent-selector {
            position: relative;
            margin-bottom: 1rem;
        }
        
        .agent-dropdown {
            width: 100%;
            background: var(--card-bg);
            border: 2px solid var(--border-color);
            border-radius: 8px;
            padding: 0.75rem;
            color: var(--text-primary);
            font-size: 0.875rem;
            transition: all 0.3s ease;
            appearance: none;
            cursor: pointer;
        }
        
        .agent-dropdown:focus {
            outline: none;
            border-color: var(--primary-green);
            box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
        }
        
        .agent-dropdown:hover {
            border-color: var(--primary-green);
        }
        
        .agent-info {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-top: 0.5rem;
            padding: 0.5rem;
            background: rgba(16, 185, 129, 0.05);
            border-radius: 6px;
            border-left: 3px solid var(--primary-green);
        }
        
        .agent-status {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.75rem;
            font-weight: 500;
        }
        
        .status-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            display: inline-block;
        }
        
        .status-ready { background: var(--success); }
        .status-thinking { 
            background: var(--warning); 
            animation: pulse 2s infinite;
        }
        .status-error { background: var(--error); }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .thinking-dots::after {
            content: '...';
            animation: thinking 1.5s infinite;
        }
        
        @keyframes thinking {
            0%, 20% { content: '.'; }
            40% { content: '..'; }
            60%, 100% { content: '...'; }
        }
        
        .agent-toolbar {
            display: flex;
            gap: 0.25rem;
            margin-top: 0.5rem;
        }
        
        .toolbar-btn {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            padding: 0.375rem;
            border-radius: 4px;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.75rem;
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .toolbar-btn:hover {
            background: var(--primary-green);
            color: white;
            transform: translateY(-1px);
        }
        
        .toolbar-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .conversation-container {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            height: 400px;
            overflow-y: auto;
            padding: 1rem;
            position: relative;
        }
        
        .conversation-empty {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            color: var(--text-secondary);
            text-align: center;
        }
        
        .conversation-empty i {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }
        
        .message-bubble {
            background: rgba(59, 130, 246, 0.1);
            border-left: 4px solid var(--primary-blue);
            margin: 0.75rem 0;
            padding: 0.875rem;
            border-radius: 8px;
            animation: slideIn 0.3s ease;
        }
        
        .message-bubble.agent-b {
            background: rgba(139, 92, 246, 0.1);
            border-left-color: var(--primary-purple);
        }
        
        .message-bubble.human {
            background: rgba(16, 185, 129, 0.1);
            border-left-color: var(--primary-green);
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .message-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }
        
        .message-sender {
            font-weight: 600;
            font-size: 0.875rem;
        }
        
        .message-sender.agent-a { color: var(--primary-blue); }
        .message-sender.agent-b { color: var(--primary-purple); }
        .message-sender.human { color: var(--primary-green); }
        
        .message-timestamp {
            font-size: 0.75rem;
            color: var(--text-secondary);
        }
        
        .message-content {
            font-size: 0.875rem;
            line-height: 1.5;
            color: var(--text-primary);
        }
        
        .message-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 0.5rem;
            font-size: 0.75rem;
            color: var(--text-secondary);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--primary-green), var(--primary-blue));
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(16, 185, 129, 0.3);
        }
        
        .btn-primary:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .btn-secondary {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            color: var(--text-primary);
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .btn-secondary:hover {
            background: var(--primary-green);
            border-color: var(--primary-green);
            color: white;
        }
        
        .btn-secondary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .control-group {
            margin-bottom: 1rem;
        }
        
        .control-label {
            display: block;
            font-size: 0.875rem;
            font-weight: 500;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
        }
        
        .control-input {
            width: 100%;
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            padding: 0.75rem;
            color: var(--text-primary);
            font-size: 0.875rem;
            transition: border-color 0.3s ease;
        }
        
        .control-input:focus {
            outline: none;
            border-color: var(--primary-green);
        }
        
        .control-textarea {
            resize: vertical;
            min-height: 100px;
            font-family: inherit;
            line-height: 1.5;
        }
        
        .mode-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 0.75rem;
            margin-bottom: 1rem;
        }
        
        .mode-btn {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            padding: 0.75rem 0.5rem;
            border-radius: 8px;
            color: var(--text-secondary);
            font-size: 0.75rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }
        
        .mode-btn:hover {
            border-color: var(--primary-green);
            color: var(--text-primary);
        }
        
        .mode-btn.active {
            background: var(--primary-green);
            border-color: var(--primary-green);
            color: white;
        }
        
        .advisor-types {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 0.5rem;
            margin-bottom: 1rem;
        }
        
        .advisor-btn {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            padding: 0.5rem 0.75rem;
            border-radius: 6px;
            color: var(--text-secondary);
            font-size: 0.75rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }
        
        .advisor-btn:hover {
            border-color: var(--primary-blue);
            color: var(--text-primary);
        }
        
        .advisor-btn.active {
            background: var(--primary-blue);
            border-color: var(--primary-blue);
            color: white;
        }
        
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 1rem;
        }
        
        .metric-card {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            padding: 1rem;
            border-radius: 8px;
            text-align: center;
        }
        
        .metric-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-green);
            margin-bottom: 0.25rem;
        }
        
        .metric-label {
            font-size: 0.75rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 1rem 1.5rem;
            border-radius: 8px;
            color: white;
            font-weight: 500;
            z-index: 1000;
            animation: slideInRight 0.3s ease;
            max-width: 400px;
        }
        
        .notification.success {
            background: var(--success);
        }
        
        .notification.error {
            background: var(--error);
        }
        
        .notification.warning {
            background: var(--warning);
        }
        
        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        .current-speaker {
            box-shadow: 0 0 20px rgba(16, 185, 129, 0.3);
            border-color: var(--primary-green) !important;
        }
        
        .loading-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(15, 23, 42, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            z-index: 10;
        }
        
        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--border-color);
            border-top: 3px solid var(--primary-green);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .responsive-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1.5rem;
        }
        
        @media (min-width: 768px) {
            .responsive-grid {
                grid-template-columns: 1fr 1fr;
            }
        }
        
        @media (min-width: 1024px) {
            .responsive-grid {
                grid-template-columns: 1fr 1fr 1fr;
            }
        }
        
        .mobile-menu {
            display: none;
        }
        
        @media (max-width: 768px) {
            .mobile-menu {
                display: block;
            }
            
            .desktop-menu {
                display: none;
            }
            
            .gradient-border-content {
                padding: 1rem;
            }
            
            .btn-primary, .btn-secondary {
                padding: 0.625rem 1rem;
                font-size: 0.875rem;
            }
            
            .conversation-container {
                height: 300px;
            }
        }
        
        .export-dropdown {
            position: relative;
            display: inline-block;
        }
        
        .export-menu {
            position: absolute;
            top: 100%;
            right: 0;
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 0.5rem 0;
            min-width: 150px;
            z-index: 100;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        }
        
        .export-item {
            padding: 0.5rem 1rem;
            cursor: pointer;
            transition: background-color 0.2s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .export-item:hover {
            background: var(--primary-green);
            color: white;
        }
        
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="border-b border-gray-700 px-4 py-3">
        <div class="max-w-7xl mx-auto flex items-center justify-between">
            <div class="flex items-center space-x-4">
                <div class="logo-text">
                    <i class="fas fa-link mr-2"></i>PromptLink
                </div>
                <span class="text-sm text-gray-400">v2.0 Revolutionary</span>
            </div>
            
            <div class="flex items-center space-x-6">
                <div class="text-sm text-gray-400">System Health:</div>
                <div id="systemHealth" class="text-green-400 font-semibold">99%</div>

<div class="status-indicator status-ready"></div>
                
                <div class="text-sm text-gray-400">Credits:</div>
                <div id="creditsCounter" class="text-white font-semibold">2,500</div>
            </div>
        </div>
    </header>

    <!-- Main Container -->
    <div class="max-w-7xl mx-auto px-4 py-6">
        <!-- Control Panel -->
        <div class="gradient-border">
            <div class="gradient-border-content">
                <h2 class="text-xl font-semibold mb-6 text-center">AI Orchestration Command Center</h2>
                
                <!-- Operation Mode Selection -->
                <div class="control-group">
                    <label class="control-label">Operation Mode</label>
                    <div class="mode-selector">
                        <div class="mode-btn active" data-mode="manual">
                            <i class="fas fa-hand-paper mb-1"></i>
                            <div>Manual Relay</div>
                        </div>
                        <div class="mode-btn" data-mode="autonomous">
                            <i class="fas fa-robot mb-1"></i>
                            <div>Autonomous</div>
                        </div>
                        <div class="mode-btn" data-mode="agent-a">
                            <i class="fas fa-user mb-1"></i>
                            <div>Agent A Only</div>
                        </div>
                        <div class="mode-btn" data-mode="agent-b">
                            <i class="fas fa-user mb-1"></i>
                            <div>Agent B Only</div>
                        </div>
                    </div>
                </div>

                <!-- Interaction Type & AI Advisor -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                    <div class="control-group">
                        <label class="control-label">Interaction Type</label>
                        <div class="advisor-types">
                            <div class="advisor-btn active" data-type="free">Free Discussion</div>
                            <div class="advisor-btn" data-type="brainstorm">Brainstorm</div>
                            <div class="advisor-btn" data-type="debate">Debate</div>
                            <div class="advisor-btn" data-type="strategy">Strategy</div>
                            <div class="advisor-btn" data-type="technical">Technical</div>
                            <div class="advisor-btn" data-type="compliance">Compliance</div>
                        </div>
                    </div>
                    
                    <div class="control-group">
                        <label class="control-label">AI Advisor</label>
                        <button id="aiAdvisorBtn" class="btn-primary w-full">
                            <i class="fas fa-magic"></i>
                            Get AI Recommendations
                        </button>
                    </div>
                </div>

                <!-- Autonomous Rounds -->
                <div class="control-group" id="autonomousControls" style="display: none;">
                    <label class="control-label">Autonomous Rounds</label>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <select id="roundsSelect" class="control-input">
                            <option value="2">2 Rounds</option>
                            <option value="5" selected>5 Rounds</option>
                            <option value="10">10 Rounds</option>
                            <option value="15">15 Rounds</option>
                            <option value="20">20 Rounds</option>
                        </select>
                        <div class="text-sm text-gray-400 flex items-center">
                            <span id="roundProgress">Ready to start</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Agent Selection -->
        <div class="responsive-grid mb-6">
            <!-- Agent A -->
            <div class="gradient-border">
                <div class="gradient-border-content">
                    <h3 class="text-lg font-semibold mb-4 text-blue-400">
                        <i class="fas fa-robot mr-2"></i>Agent A
                    </h3>
                    
                    <div class="agent-selector">
                        <select id="agentASelect" class="agent-dropdown">
                            <option value="">Select Agent A...</option>
                            <option value="tngtech/deepseek-r1t2-chimera:free">TNG: DeepSeek R1T2 Chimera</option>
                            <option value="minimax/minimax-m1">MinMax M1</option>
                            <option value="meta-llama/llama-3-8b-instruct">Llama 3.3</option>
                            <option value="mistralai/mistral-large-2407">Mistral Large</option>
                            <option value="openai/gpt-4-turbo">ChatGPT 4 Turbo</option>
                        </select>
                        
                        <div class="agent-info" id="agentAInfo" style="display: none;">
                            <div>
                                <div class="font-semibold text-blue-400" id="agentAName">Agent A</div>
                                <div class="text-xs text-gray-400" id="agentADesc">Select an agent to see description</div>
                            </div>
                            <div class="agent-status">
                                <div class="status-indicator status-ready" id="agentAStatus"></div>
                                <span id="agentAStatusText">Ready</span>
                            </div>
                        </div>
                        
                        <div class="agent-toolbar" id="agentAToolbar" style="display: none;">
                            <button class="toolbar-btn" title="Copy Response" data-action="copy">
                                <i class="fas fa-copy"></i>
                            </button>
                            <button class="toolbar-btn" title="Regenerate" data-action="regenerate">
                                <i class="fas fa-redo"></i>
                            </button>
                            <button class="toolbar-btn" title="Edit" data-action="edit">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="toolbar-btn" title="Download" data-action="download">
                                <i class="fas fa-download"></i>
                            </button>
                            <button class="toolbar-btn" title="Thumbs Up" data-action="thumbsup">
                                <i class="fas fa-thumbs-up"></i>
                            </button>
                            <button class="toolbar-btn" title="Thumbs Down" data-action="thumbsdown">
                                <i class="fas fa-thumbs-down"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div class="conversation-container" id="agentAConversation">
                        <div class="conversation-empty">
                            <i class="fas fa-comment-dots"></i>
                            <p>Agent A ready for collaboration</p>
                            <p class="text-sm">Select an agent and start a session</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Agent B -->
            <div class="gradient-border">
                <div class="gradient-border-content">
                    <h3 class="text-lg font-semibold mb-4 text-purple-400">
                        <i class="fas fa-robot mr-2"></i>Agent B
                    </h3>
                    
                    <div class="agent-selector">
                        <select id="agentBSelect" class="agent-dropdown">
                            <option value="">Select Agent B...</option>
                            <option value="tngtech/deepseek-r1t2-chimera:free">TNG: DeepSeek R1T2 Chimera</option>
                            <option value="minimax/minimax-m1">MinMax M1</option>
                            <option value="meta-llama/llama-3-8b-instruct">Llama 3.3</option>
                            <option value="mistralai/mistral-large-2407">Mistral Large</option>
                            <option value="openai/gpt-4-turbo">ChatGPT 4 Turbo</option>
                        </select>
                        
                        <div class="agent-info" id="agentBInfo" style="display: none;">
                            <div>
                                <div class="font-semibold text-purple-400" id="agentBName">Agent B</div>
                                <div class="text-xs text-gray-400" id="agentBDesc">Select an agent to see description</div>
                            </div>
                            <div class="agent-status">
                                <div class="status-indicator status-ready" id="agentBStatus"></div>
                                <span id="agentBStatusText">Ready</span>
                            </div>
                        </div>
                        
                        <div class="agent-toolbar" id="agentBToolbar" style="display: none;">
                            <button class="toolbar-btn" title="Copy Response" data-action="copy">
                                <i class="fas fa-copy"></i>
                            </button>
                            <button class="toolbar-btn" title="Regenerate" data-action="regenerate">
                                <i class="fas fa-redo"></i>
                            </button>
                            <button class="toolbar-btn" title="Edit" data-action="edit">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="toolbar-btn" title="Download" data-action="download">
                                <i class="fas fa-download"></i>
                            </button>
                            <button class="toolbar-btn" title="Thumbs Up" data-action="thumbsup">
                                <i class="fas fa-thumbs-up"></i>
                            </button>
                            <button class="toolbar-btn" title="Thumbs Down" data-action="thumbsdown">
                                <i class="fas fa-thumbs-down"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div class="conversation-container" id="agentBConversation">
                        <div class="conversation-empty">
                            <i class="fas fa-comment-dots"></i>
                            <p>Agent B ready for collaboration</p>
                            <p class="text-sm">Select an agent and start a session</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Initial Prompt -->
        <div class="gradient-border">
            <div class="gradient-border-content">
                <h3 class="text-lg font-semibold mb-4 text-green-400">
                    <i class="fas fa-edit mr-2"></i>Initial Prompt
                </h3>
                
                <div class="control-group">
                    <textarea 
                        id="initialPrompt" 
                        class="control-input control-textarea" 
                        placeholder="Enter your initial prompt for AI relay discussion..."
                        rows="4"
                    >Let's discuss the future of AI and the developments in the next six months and what significance will those massive developments have on the overall timeline and advancements</textarea>
                </div>
                
                <div class="flex flex-wrap gap-3 justify-center">
                    <button id="startSessionBtn" class="btn-primary">
                        <i class="fas fa-play"></i>
                        Start Session
                    </button>
                    <button id="nextStepBtn" class="btn-secondary" disabled>
                        <i class="fas fa-step-forward"></i>
                        Next Step
                    </button>
                    <button id="pauseBtn" class="btn-secondary" disabled>
                        <i class="fas fa-pause"></i>
                        Pause
                    </button>
                    <button id="stopBtn" class="btn-secondary" disabled>
                        <i class="fas fa-stop"></i>
                        Stop
                    </button>
                    <button id="clearBtn" class="btn-secondary">
                        <i class="fas fa-trash"></i>
                        Clear All
                    </button>
                </div>
            </div>
        </div>

        <!-- Human Controller -->
        <div class="gradient-border">
            <div class="gradient-border-content">
                <h3 class="text-lg font-semibold mb-4 text-green-400">
                    <i class="fas fa-user-cog mr-2"></i>Human Controller
                </h3>
                
                <div class="control-group">
                    <label class="control-label">Interject with custom message or guidance...</label>
                    <div class="flex gap-2">
                        <textarea 
                            id="humanMessage" 
                            class="control-input control-textarea" 
                            placeholder="Add guidance or instructions for the agents..."
                            rows="2"
                        ></textarea>
                        <button id="sendHumanBtn" class="btn-primary">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-4">
                    <div class="control-group">
                        <label class="control-label">Session Status</label>
                        <input type="text" id="sessionStatus" class="control-input" value="Inactive" readonly>
                    </div>
                    <div class="control-group">
                        <label class="control-label">Current Speaker</label>
                        <input type="text" id="currentSpeaker" class="control-input" value="None" readonly>
                    </div>
                    <div class="control-group">
                        <label class="control-label">Session ID</label>
                        <input type="text" id="sessionId" class="control-input" value="None" readonly>
                    </div>
                </div>
            </div>
        </div>

        <!-- Session Export -->
        <div class="gradient-border">
            <div class="gradient-border-content">
                <h3 class="text-lg font-semibold mb-4 text-purple-400">
                    <i class="fas fa-database mr-2"></i>Session Export
                </h3>
                
                <div class="flex flex-wrap gap-3 justify-center">
                    <button id="exportMarkdownBtn" class="btn-primary">
                        <i class="fas fa-file-text"></i>
                        Export Markdown
                    </button>
                    <button id="exportJSONBtn" class="btn-secondary">
                        <i class="fas fa-file-code"></i>
                        Export JSON
                    </button>
                    <button id="exportTXTBtn" class="btn-secondary">
                        <i class="fas fa-file-alt"></i>
                        Export TXT
                    </button>
                    <button id="exportCSVBtn" class="btn-secondary">
                        <i class="fas fa-table"></i>
                        Export CSV
                    </button>
                </div>
            </div>
        </div>

        <!-- Live Diagnostics -->
        <div class="gradient-border">
            <div class="gradient-border-content">
                <h3 class="text-lg font-semibold mb-4 text-blue-400">
                    <i class="fas fa-chart-line mr-2"></i>Live Diagnostics
                </h3>
                
                <div class="metrics-grid">
                    <div class="metric-card">
                        <div class="metric-value" id="sessionTime">0s</div>
                        <div class="metric-label">Session Time</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="totalMessages">0</div>
                        <div class="metric-label">Total Messages</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="activeAgents">0</div>
                        <div class="metric-label">Active Agents</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="currentRound">0</div>
                        <div class="metric-label">Current Round</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="totalTokens">0</div>
                        <div class="metric-label">Total Tokens</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="avgResponseTime">0ms</div>
                        <div class="metric-label">Avg Response</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

<script>
        // Configuration
        const API_BASE_URL = 'https://web-production-2474.up.railway.app';
        
        // Agent configurations
        const AGENT_CONFIGS = {
            'tngtech/deepseek-r1t2-chimera:free': {
                name: 'TNG: DeepSeek R1T2 Chimera',
                description: 'Advanced reasoning model with 671B parameters',
                color: 'blue',
                icon: '🧠'
            },
            'minimax/minimax-m1': {
                name: 'MinMax M1',
                description: 'Strategic planning and optimization specialist',
                color: 'purple',
                icon: '🎯'
            },
            'meta-llama/llama-3-8b-instruct': {
                name: 'Llama 3.3',
                description: 'Meta\'s efficient text generation model',
                color: 'orange',
                icon: '🦙'
            },
            'mistralai/mistral-large-2407': {
                name: 'Mistral Large',
                description: 'Multilingual model for complex tasks',
                color: 'red',
                icon: '💨'
            },
            'openai/gpt-4-turbo': {
                name: 'ChatGPT 4 Turbo',
                description: 'OpenAI\'s versatile conversational model',
                color: 'green',
                icon: '💬'
            }
        };
        
        // AI Advisor recommendations
        const ADVISOR_RECOMMENDATIONS = {
            'free': {
                agentA: 'openai/gpt-4-turbo',
                agentB: 'meta-llama/llama-3-8b-instruct',
                reason: 'Versatile conversation with efficient responses'
            },
            'brainstorm': {
                agentA: 'openai/gpt-4-turbo',
                agentB: 'tngtech/deepseek-r1t2-chimera:free',
                reason: 'Creative ideation with advanced reasoning'
            },
            'debate': {
                agentA: 'tngtech/deepseek-r1t2-chimera:free',
                agentB: 'mistralai/mistral-large-2407',
                reason: 'Deep reasoning vs multilingual perspective'
            },
            'strategy': {
                agentA: 'minimax/minimax-m1',
                agentB: 'openai/gpt-4-turbo',
                reason: 'Strategic optimization with versatile analysis'
            },
            'technical': {
                agentA: 'tngtech/deepseek-r1t2-chimera:free',
                agentB: 'meta-llama/llama-3-8b-instruct',
                reason: 'Advanced reasoning with technical efficiency'
            },
            'compliance': {
                agentA: 'mistralai/mistral-large-2407',
                agentB: 'openai/gpt-4-turbo',
                reason: 'Regulatory expertise with comprehensive analysis'
            }
        };
        
        // Global state
        let appState = {
            sessionId: null,
            mode: 'manual',
            interactionType: 'free',
            agentA: null,
            agentB: null,
            sessionActive: false,
            isPaused: false,
            isAutonomous: false,
            currentRound: 0,
            maxRounds: 5,
            currentSpeaker: null,
            conversation: [],
            sessionStartTime: null,
            totalTokens: 0,
            responseTimes: []
        };
        
        // DOM elements
        const elements = {
            // Mode selection
            modeButtons: document.querySelectorAll('.mode-btn'),
            advisorButtons: document.querySelectorAll('.advisor-btn'),
            autonomousControls: document.getElementById('autonomousControls'),
            roundsSelect: document.getElementById('roundsSelect'),
            roundProgress: document.getElementById('roundProgress'),
            
            // Agent selection
            agentASelect: document.getElementById('agentASelect'),
            agentBSelect: document.getElementById('agentBSelect'),
            agentAInfo: document.getElementById('agentAInfo'),
            agentBInfo: document.getElementById('agentBInfo'),
            agentAName: document.getElementById('agentAName'),
            agentBName: document.getElementById('agentBName'),
            agentADesc: document.getElementById('agentADesc'),
            agentBDesc: document.getElementById('agentBDesc'),
            agentAStatus: document.getElementById('agentAStatus'),
            agentBStatus: document.getElementById('agentBStatus'),
            agentAStatusText: document.getElementById('agentAStatusText'),
            agentBStatusText: document.getElementById('agentBStatusText'),
            agentAToolbar: document.getElementById('agentAToolbar'),
            agentBToolbar: document.getElementById('agentBToolbar'),
            
            // Conversations
            agentAConversation: document.getElementById('agentAConversation'),
            agentBConversation: document.getElementById('agentBConversation'),
            
            // Controls
            initialPrompt: document.getElementById('initialPrompt'),
            humanMessage: document.getElementById('humanMessage'),
            startSessionBtn: document.getElementById('startSessionBtn'),
            nextStepBtn: document.getElementById('nextStepBtn'),
            pauseBtn: document.getElementById('pauseBtn'),
            stopBtn: document.getElementById('stopBtn'),
            clearBtn: document.getElementById('clearBtn'),
            sendHumanBtn: document.getElementById('sendHumanBtn'),
            aiAdvisorBtn: document.getElementById('aiAdvisorBtn'),
            
            // Status
            sessionStatus: document.getElementById('sessionStatus'),
            currentSpeaker: document.getElementById('currentSpeaker'),
            sessionId: document.getElementById('sessionId'),
            
            // Export
            exportMarkdownBtn: document.getElementById('exportMarkdownBtn'),
            exportJSONBtn: document.getElementById('exportJSONBtn'),
            exportTXTBtn: document.getElementById('exportTXTBtn'),
            exportCSVBtn: document.getElementById('exportCSVBtn'),
            
            // Metrics
            sessionTime: document.getElementById('sessionTime'),
            totalMessages: document.getElementById('totalMessages'),
            activeAgents: document.getElementById('activeAgents'),
            currentRound: document.getElementById('currentRound'),
            totalTokens: document.getElementById('totalTokens'),
            avgResponseTime: document.getElementById('avgResponseTime'),
            systemHealth: document.getElementById('systemHealth'),
            creditsCounter: document.getElementById('creditsCounter')
        };
        
        // Initialize application
        document.addEventListener('DOMContentLoaded', function() {
            initializeEventListeners();
            updateUI();
            startMetricsUpdater();
        });
        
        function initializeEventListeners() {
            // Mode selection
            elements.modeButtons.forEach(btn => {
                btn.addEventListener('click', function() {
                    elements.modeButtons.forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    appState.mode = this.dataset.mode;
                    updateModeUI();
                });
            });
            
            // Interaction type selection
            elements.advisorButtons.forEach(btn => {
                btn.addEventListener('click', function() {
                    elements.advisorButtons.forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    appState.interactionType = this.dataset.type;
                });
            });
            
            // Agent selection
            elements.agentASelect.addEventListener('change', function() {
                appState.agentA = this.value;
                updateAgentInfo('A');
            });
            
            elements.agentBSelect.addEventListener('change', function() {
                appState.agentB = this.value;
                updateAgentInfo('B');
            });
            
            // Control buttons
            elements.startSessionBtn.addEventListener('click', startSession);
            elements.nextStepBtn.addEventListener('click', nextStep);
            elements.pauseBtn.addEventListener('click', pauseSession);
            elements.stopBtn.addEventListener('click', stopSession);
            elements.clearBtn.addEventListener('click', clearAll);
            elements.sendHumanBtn.addEventListener('click', sendHumanMessage);
            elements.aiAdvisorBtn.addEventListener('click', applyAIAdvisor);
            
            // Export buttons
            elements.exportMarkdownBtn.addEventListener('click', () => exportSession('markdown'));
            elements.exportJSONBtn.addEventListener('click', () => exportSession('json'));
            elements.exportTXTBtn.addEventListener('click', () => exportSession('txt'));
            elements.exportCSVBtn.addEventListener('click', () => exportSession('csv'));
            
            // Toolbar buttons
            document.addEventListener('click', function(e) {
                if (e.target.closest('.toolbar-btn')) {
                    const btn = e.target.closest('.toolbar-btn');
                    const action = btn.dataset.action;
                    const agent = btn.closest('[id*="agent"]').id.includes('A') ? 'A' : 'B';
                    handleToolbarAction(action, agent);
                }
            });
            
            // Keyboard shortcuts
            document.addEventListener('keydown', function(e) {
                if (e.ctrlKey && e.key === 'Enter') {
                    if (document.activeElement === elements.initialPrompt) {
                        startSession();
                    } else if (document.activeElement === elements.humanMessage) {
                        sendHumanMessage();
                    }
                }
            });
        }
        
        function updateModeUI() {
            elements.autonomousControls.style.display = appState.mode === 'autonomous' ? 'block' : 'none';
            updateUI();
        }
        
        function updateAgentInfo(agent) {
            const selectEl = agent === 'A' ? elements.agentASelect : elements.agentBSelect;
            const infoEl = agent === 'A' ? elements.agentAInfo : elements.agentBInfo;
            const nameEl = agent === 'A' ? elements.agentAName : elements.agentBName;
            const descEl = agent === 'A' ? elements.agentADesc : elements.agentBDesc;
            const toolbarEl = agent === 'A' ? elements.agentAToolbar : elements.agentBToolbar;
            
            const selectedModel = selectEl.value;
            
            if (selectedModel && AGENT_CONFIGS[selectedModel]) {
                const config = AGENT_CONFIGS[selectedModel];
                nameEl.textContent = config.name;
                descEl.textContent = config.description;
                infoEl.style.display = 'block';
                toolbarEl.style.display = 'flex';
            } else {
                infoEl.style.display = 'none';
                toolbarEl.style.display = 'none';
            }
            
            updateUI();
        }
        
        function applyAIAdvisor() {
            const recommendation = ADVISOR_RECOMMENDATIONS[appState.interactionType];
            if (recommendation) {
                elements.agentASelect.value = recommendation.agentA;
                elements.agentBSelect.value = recommendation.agentB;
                appState.agentA = recommendation.agentA;
                appState.agentB = recommendation.agentB;
                updateAgentInfo('A');
                updateAgentInfo('B');
                showNotification(`AI Advisor: ${recommendation.reason}`, 'success');
            }
        }
        
        async function startSession() {
            if (!appState.agentA || !appState.agentB) {
                showNotification('Please select both Agent A and Agent B before starting.', 'error');
                return;
            }
            
            if (appState.agentA === appState.agentB) {
                showNotification('Please select different agents for A and B.', 'error');
                return;
            }
            
            const prompt = elements.initialPrompt.value.trim();
            if (!prompt) {
                showNotification('Please enter an initial prompt.', 'error');
                return;
            }
            
            // Initialize session
            appState.sessionId = 'session_' + Date.now();
            appState.sessionActive = true;
            appState.isPaused = false;
            appState.sessionStartTime = Date.now();
            appState.currentRound = 0;
            appState.maxRounds = parseInt(elements.roundsSelect.value);
            appState.conversation = [];
            appState.currentSpeaker = 'A';
            
            // Clear conversations
            clearConversations();
            
            // Update UI
            updateSessionControls();
            updateUI();
            
            showNotification('Session started successfully!', 'success');
            
            // Start with Agent A
            if (appState.mode === 'autonomous') {
                appState.isAutonomous = true;
                await sendToAgent('A', prompt);
            } else if (appState.mode === 'agent-a') {
                await sendToAgent('A', prompt);
            } else if (appState.mode === 'agent-b') {
                await sendToAgent('B', prompt);
            } else {
                // Manual mode - wait for Next Step
                await sendToAgent('A', prompt);
            }
        }
        
        async function nextStep() {
            if (!appState.sessionActive || appState.isPaused) return;
            
            const nextAgent = appState.currentSpeaker === 'A' ? 'B' : 'A';
            const lastMessage = appState.conversation[appState.conversation.length - 1];
            
            if (lastMessage) {
                await sendToAgent(nextAgent, lastMessage.content);
            }
        }
        
        function pauseSession() {
            appState.isPaused = true;
            appState.isAutonomous = false;
            updateSessionControls();
            showNotification('Session paused. Use Next Step to continue.', 'warning');
        }
        
        function stopSession() {
            appState.sessionActive = false;
            appState.isPaused = false;
            appState.isAutonomous = false;
            appState.currentSpeaker = null;
            updateSessionControls();
            updateUI();
            showNotification('Session stopped.', 'success');
        }
        
        function clearAll() {
            appState.conversation = [];
            appState.totalTokens = 0;
            appState.responseTimes = [];
            clearConversations();
            updateUI();
            showNotification('All conversations cleared.', 'success');
        }
        
        async function sendHumanMessage() {
            const message = elements.humanMessage.value.trim();
            if (!message) return;
            
            const messageObj = {
                sender: 'human',
                content: message,
timestamp: Date.now(),
                tokens: estimateTokens(message)
            };
            
            appState.conversation.push(messageObj);
            displayMessage(messageObj);
            elements.humanMessage.value = '';
            
            updateUI();
            showNotification('Human message sent.', 'success');
        }
        
        async function sendToAgent(agent, message) {
            const agentModel = agent === 'A' ? appState.agentA : appState.agentB;
            if (!agentModel) return;
            
            const statusEl = agent === 'A' ? elements.agentAStatus : elements.agentBStatus;
            const statusTextEl = agent === 'A' ? elements.agentAStatusText : elements.agentBStatusText;
            
            // Update status to thinking
            statusEl.className = 'status-indicator status-thinking';
            statusTextEl.innerHTML = 'Thinking<span class="thinking-dots"></span>';
            
            // Highlight current speaker
            highlightCurrentSpeaker(agent);
            
            const startTime = Date.now();
            
            try {
                const response = await callRailwayAPI(agentModel, message);
                const responseTime = Date.now() - startTime;
                
                const messageObj = {
                    sender: agent.toLowerCase(),
                    agentName: AGENT_CONFIGS[agentModel].name,
                    content: response,
                    timestamp: Date.now(),
                    responseTime: responseTime,
                    tokens: estimateTokens(response)
                };
                
                appState.conversation.push(messageObj);
                appState.totalTokens += messageObj.tokens;
                appState.responseTimes.push(responseTime);
                
                displayMessage(messageObj);
                
                // Update status back to ready
                statusEl.className = 'status-indicator status-ready';
                statusTextEl.textContent = 'Ready';
                
                // Continue autonomous conversation
                if (appState.isAutonomous && appState.currentRound < appState.maxRounds) {
                    appState.currentRound++;
                    appState.currentSpeaker = agent === 'A' ? 'B' : 'A';
                    
                    setTimeout(() => {
                        if (appState.isAutonomous) {
                            sendToAgent(appState.currentSpeaker, response);
                        }
                    }, 2000);
                } else if (appState.isAutonomous && appState.currentRound >= appState.maxRounds) {
                    showNotification(`Autonomous session completed after ${appState.maxRounds} rounds.`, 'success');
                    appState.isAutonomous = false;
                    appState.currentSpeaker = null;
                } else {
                    // Manual mode - set next speaker
                    appState.currentSpeaker = agent === 'A' ? 'B' : 'A';
                }
                
                updateUI();
                
            } catch (error) {
                console.error('Error sending to agent:', error);
                statusEl.className = 'status-indicator status-error';
                statusTextEl.textContent = 'Error';
                showNotification(`Error communicating with ${AGENT_CONFIGS[agentModel].name}: ${error.message}`, 'error');
            }
        }
        
        async function callRailwayAPI(model, message) {
            const agentId = getAgentIdFromModel(model);
            
            const response = await fetch(`${API_BASE_URL}/api/chat`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Accept': 'application/json'
                },
                body: JSON.stringify({
                    message: message,
                    agents: [agentId]
                })
            });
            
            if (!response.ok) {
                const errorData = await response.json().catch(() => ({}));
                throw new Error(errorData.error || `API request failed with status ${response.status}`);
            }
            
            const data = await response.json();
            
            if (data.success && data.responses && data.responses[agentId]) {
                const agentResponse = data.responses[agentId];
                if (agentResponse.status === 'success') {
                    return agentResponse.response;
                } else {
                    throw new Error(agentResponse.error || 'Agent response failed');
                }
            } else {
                throw new Error('Invalid response format from API');
            }
        }
        
        function getAgentIdFromModel(model) {
            const modelMap = {
                'tngtech/deepseek-r1t2-chimera:free': 'deepseek',
                'minimax/minimax-m1': 'minmax',
                'meta-llama/llama-3-8b-instruct': 'llama',
                'mistralai/mistral-large-2407': 'mistral',
                'openai/gpt-4-turbo': 'chatgpt'
            };
            return modelMap[model] || 'chatgpt';
        }
        
        function displayMessage(messageObj) {
            const messageEl = document.createElement('div');
            messageEl.className = `message-bubble ${messageObj.sender}`;
            
            const senderName = messageObj.agentName || (messageObj.sender === 'human' ? 'Human' : `Agent ${messageObj.sender.toUpperCase()}`);
            const senderClass = messageObj.sender === 'human' ? 'human' : `agent-${messageObj.sender}`;
            
            messageEl.innerHTML = `
                <div class="message-header">
                    <span class="message-sender ${senderClass}">${senderName}</span>
                    <span class="message-timestamp">${formatTimestamp(messageObj.timestamp)}</span>
                </div>
                <div class="message-content">${messageObj.content}</div>
                ${messageObj.responseTime ? `
                    <div class="message-meta">
                        <span>Response time: ${messageObj.responseTime}ms</span>
                        <span>Tokens: ${messageObj.tokens}</span>
                    </div>
                ` : ''}
            `;
            
            // Add to appropriate conversation areas
            if (messageObj.sender === 'a') {
                clearEmptyState(elements.agentAConversation);
                elements.agentAConversation.appendChild(messageEl);
                elements.agentAConversation.scrollTop = elements.agentAConversation.scrollHeight;
            } else if (messageObj.sender === 'b') {
                clearEmptyState(elements.agentBConversation);
                elements.agentBConversation.appendChild(messageEl);
                elements.agentBConversation.scrollTop = elements.agentBConversation.scrollHeight;
            }
        }
        
        function clearEmptyState(container) {
            const emptyState = container.querySelector('.conversation-empty');
            if (emptyState) {
                emptyState.remove();
            }
        }
        
        function clearConversations() {
            elements.agentAConversation.innerHTML = `
                <div class="conversation-empty">
                    <i class="fas fa-comment-dots"></i>
                    <p>Agent A ready for collaboration</p>
                    <p class="text-sm">Select an agent and start a session</p>
                </div>
            `;
            elements.agentBConversation.innerHTML = `
                <div class="conversation-empty">
                    <i class="fas fa-comment-dots"></i>
                    <p>Agent B ready for collaboration</p>
                    <p class="text-sm">Select an agent and start a session</p>
                </div>
            `;
        }
        
        function highlightCurrentSpeaker(agent) {
            // Remove previous highlights
            elements.agentAConversation.parentElement.classList.remove('current-speaker');
            elements.agentBConversation.parentElement.classList.remove('current-speaker');
            
            // Add highlight to current speaker
            if (agent === 'A') {
                elements.agentAConversation.parentElement.classList.add('current-speaker');
            } else if (agent === 'B') {
                elements.agentBConversation.parentElement.classList.add('current-speaker');
            }
        }
        
        function updateSessionControls() {
            elements.startSessionBtn.disabled = appState.sessionActive;
            elements.nextStepBtn.disabled = !appState.sessionActive || appState.isPaused || appState.isAutonomous;
            elements.pauseBtn.disabled = !appState.sessionActive || appState.isPaused || !appState.isAutonomous;
            elements.stopBtn.disabled = !appState.sessionActive;
        }
        
        function updateUI() {
            // Update session status
            elements.sessionStatus.value = appState.sessionActive ? 
                (appState.isPaused ? 'Paused' : 'Active') : 'Inactive';
            elements.currentSpeaker.value = appState.currentSpeaker || 'None';
            elements.sessionId.value = appState.sessionId || 'None';
            
            // Update metrics
            elements.totalMessages.textContent = appState.conversation.length;
            elements.activeAgents.textContent = [appState.agentA, appState.agentB].filter(Boolean).length;
            elements.currentRound.textContent = appState.currentRound;
            elements.totalTokens.textContent = appState.totalTokens;
            
            if (appState.responseTimes.length > 0) {
                const avgTime = appState.responseTimes.reduce((a, b) => a + b, 0) / appState.responseTimes.length;
                elements.avgResponseTime.textContent = Math.round(avgTime) + 'ms';
            }
            
            // Update round progress
            if (appState.mode === 'autonomous') {
                elements.roundProgress.textContent = appState.sessionActive ? 
                    `Round ${appState.currentRound}/${appState.maxRounds}` : 'Ready to start';
            }
            
            updateSessionControls();
        }
        
        function handleToolbarAction(action, agent) {
            const lastMessage = appState.conversation
                .filter(msg => msg.sender === agent.toLowerCase())
                .pop();
            
            if (!lastMessage) return;
            
            switch (action) {
                case 'copy':
                    navigator.clipboard.writeText(lastMessage.content);
                    showNotification('Response copied to clipboard!', 'success');
                    break;
                case 'regenerate':
                    if (appState.sessionActive) {
                        const prevMessage = appState.conversation
                            .filter(msg => msg.sender !== agent.toLowerCase())
                            .pop();
                        if (prevMessage) {
                            sendToAgent(agent, prevMessage.content);
                        }
                    }
                    break;
                case 'download':
                    downloadText(lastMessage.content, `${lastMessage.agentName}_response.txt`);
                    break;
                case 'edit':
                    const newContent = prompt('Edit response:', lastMessage.content);
                    if (newContent !== null) {
                        lastMessage.content = newContent;
                        // Re-render conversation
                        // Implementation depends on your specific needs
                    }
                    break;
                case 'thumbsup':
                case 'thumbsdown':
                    // Store feedback (implement as needed)
                    showNotification(`Feedback recorded for ${lastMessage.agentName}`, 'success');
                    break;
            }
        }
        
        function exportSession(format) {
            if (appState.conversation.length === 0) {
                showNotification('No conversation to export.', 'warning');
                return;
            }
            
            let content = '';
            let filename = `promptlink_session_${Date.now()}`;
            
            switch (format) {
                case 'markdown':
                    content = generateMarkdown();
                    filename += '.md';
                    break;
                case 'json':
                    content = JSON.stringify({
                        sessionId: appState.sessionId,
                        mode: appState.mode,
                        interactionType: appState.interactionType,
                        agentA: appState.agentA,
                        agentB: appState.agentB,
                        conversation: appState.conversation,
                        totalTokens: appState.totalTokens,
                        sessionDuration: appState.sessionStartTime ? Date.now() - appState.sessionStartTime : 0
                    }, null, 2);
                    filename += '.json';
                    break;
                case 'txt':
                    content = generatePlainText();
                    filename += '.txt';
                    break;
                case 'csv':
                    content = generateCSV();
                    filename += '.csv';
                    break;
            }
            
            downloadText(content, filename);
            showNotification(`Session exported as ${format.toUpperCase()}!`, 'success');
        }
        
        function generateMarkdown() {
            let md = `# PromptLink Session Export\n\n`;
            md += `**Session ID:** ${appState.sessionId}\n`;
            md += `**Mode:** ${appState.mode}\n`;
            md += `**Interaction Type:** ${appState.interactionType}\n`;
            md += `**Agent A:** ${AGENT_CONFIGS[appState.agentA]?.name || appState.agentA}\n`;
            md += `**Agent B:** ${AGENT_CONFIGS[appState.agentB]?.name || appState.agentB}\n`;
            md += `**Total Messages:** ${appState.conversation.length}\n`;
            md += `**Total Tokens:** ${appState.totalTokens}\n\n`;
            
            md += `## Conversation\n\n`;
            
            appState.conversation.forEach((msg, index) => {
                const senderName = msg.agentName || (msg.sender === 'human' ? 'Human' : `Agent ${msg.sender.toUpperCase()}`);
                md += `### ${senderName} (${formatTimestamp(msg.timestamp)})\n\n`;
                md += `${msg.content}\n\n`;
                if (msg.responseTime) {
                    md += `*Response time: ${msg.responseTime}ms | Tokens: ${msg.tokens}*\n\n`;
                }
            });
            
            return md;
        }
        
        function generatePlainText() {
            let txt = `PROMPTLINK SESSION EXPORT\n`;
            txt += `Session ID: ${appState.sessionId}\n`;
            txt += `Mode: ${appState.mode}\n`;
            txt += `Interaction Type: ${appState.interactionType}\n`;
            txt += `Agent A: ${AGENT_CONFIGS[appState.agentA]?.name || appState.agentA}\n`;
            txt += `Agent B: ${AGENT_CONFIGS[appState.agentB]?.name || appState.agentB}\n`;
            txt += `Total Messages: ${appState.conversation.length}\n`;
            txt += `Total Tokens: ${appState.totalTokens}\n\n`;
            
            txt += `CONVERSATION:\n\n`;
            
            appState.conversation.forEach((msg, index) => {
                const senderName = msg.agentName || (msg.sender === 'human' ? 'Human' : `Agent ${msg.sender.toUpperCase()}`);
                txt += `[${formatTimestamp(msg.timestamp)}] ${senderName}:\n`;
                txt += `${msg.content}\n`;
                if (msg.responseTime) {
                    txt += `(Response time: ${msg.responseTime}ms | Tokens: ${msg.tokens})\n`;
                }
                txt += `\n`;
            });
            
            return txt;
        }
        
        function generateCSV() {
            let csv = `Timestamp,Sender,Agent Name,Content,Response Time,Tokens\n`;
            
            appState.conversation.forEach(msg => {
                const senderName = msg.agentName || (msg.sender === 'human' ? 'Human' : `Agent ${msg.sender.toUpperCase()}`);
                const content = msg.content.replace(/"/g, '""'); // Escape quotes
                csv += `"${formatTimestamp(msg.timestamp)}","${msg.sender}","${senderName}","${content}","${msg.responseTime || ''}","${msg.tokens || ''}"\n`;
            });
            
            return csv;
        }
        
        function downloadText(content, filename) {
            const blob = new Blob([content], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            a.click();
            URL.revokeObjectURL(url);
        }
        
        function formatTimestamp(timestamp) {
            return new Date(timestamp).toLocaleString();
        }
        
        function estimateTokens(text) {
            // Simple token estimation (roughly 4 characters per token)
            return Math.ceil(text.length / 4);
        }
        
        function showNotification(message, type = 'success') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 5000);
        }
        
        function startMetricsUpdater() {
            setInterval(() => {
                if (appState.sessionActive && appState.sessionStartTime) {
                    const elapsed = Math.floor((Date.now() - appState.sessionStartTime) / 1000);
                    elements.sessionTime.textContent = formatDuration(elapsed);
                }
                
                // Simulate system health fluctuation
                const currentHealth = parseInt(elements.systemHealth.textContent) || 99;
                const newHealth = Math.max(95, Math.min(100, currentHealth + (Math.random() - 0.5) * 2));
                elements.systemHealth.textContent = Math.floor(newHealth) + '%';
                
                // Update credits (simulate usage)
                if (appState.sessionActive && appState.conversation.length > 0) {
                    const currentCredits = parseInt(elements.creditsCounter.textContent) || 2500;
                    const newCredits = Math.max(0, currentCredits - Math.floor(Math.random() * 2));
                    elements.creditsCounter.textContent = newCredits;
                }
            }, 1000);
        }
        
        function formatDuration(seconds) {
            const hours = Math.floor(seconds / 3600);
            const minutes = Math.floor((seconds % 3600) / 60);
            const secs = seconds % 60;
            
            if (hours > 0) {
                return `${hours}h ${minutes}m ${secs}s`;
            } else if (minutes > 0) {
                return `${minutes}m ${secs}s`;
            } else {
                return `${secs}s`;
            }
        }
    </script>
</body>
</html>
